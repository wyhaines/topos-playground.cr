<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.9.2">
<meta name="crystal_docs.project_version" content="main">
<meta name="crystal_docs.project_name" content="topos-playground.cr">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="topos-playground.cr">
  <title>topos-playground.cr main</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          topos-playground.cr
        </a>
      </h1>

      <span class="project-version">
        main
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="topos-playground.cr/OptionParser" data-name="optionparser">
      <a href="OptionParser.html">OptionParser</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/SemanticVersion" data-name="semanticversion">
      <a href="SemanticVersion.html">SemanticVersion</a>
      
    </li>
  
  <li class="parent " data-id="topos-playground.cr/ToposPlayground" data-name="toposplayground">
      <a href="ToposPlayground.html">ToposPlayground</a>
      
        <ul>
  
  <li class="parent " data-id="topos-playground.cr/ToposPlayground/Command" data-name="toposplayground::command">
      <a href="ToposPlayground/Command.html">Command</a>
      
        <ul>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Clean" data-name="toposplayground::command::clean">
      <a href="ToposPlayground/Command/Clean.html">Clean</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Error" data-name="toposplayground::command::error">
      <a href="ToposPlayground/Command/Error.html">Error</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Log" data-name="toposplayground::command::log">
      <a href="ToposPlayground/Command/Log.html">Log</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Logs" data-name="toposplayground::command::logs">
      <a href="ToposPlayground/Command/Logs.html">Logs</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Start" data-name="toposplayground::command::start">
      <a href="ToposPlayground/Command/Start.html">Start</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Command/Version" data-name="toposplayground::command::version">
      <a href="ToposPlayground/Command/Version.html">Version</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/CommandRegistry" data-name="toposplayground::commandregistry">
      <a href="ToposPlayground/CommandRegistry.html">CommandRegistry</a>
      
    </li>
  
  <li class="parent " data-id="topos-playground.cr/ToposPlayground/Env" data-name="toposplayground::env">
      <a href="ToposPlayground/Env.html">Env</a>
      
        <ul>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Env/DappBackend" data-name="toposplayground::env::dappbackend">
      <a href="ToposPlayground/Env/DappBackend.html">DappBackend</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Env/DappFrontend" data-name="toposplayground::env::dappfrontend">
      <a href="ToposPlayground/Env/DappFrontend.html">DappFrontend</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Env/ExecutorService" data-name="toposplayground::env::executorservice">
      <a href="ToposPlayground/Env/ExecutorService.html">ExecutorService</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Env/Secrets" data-name="toposplayground::env::secrets">
      <a href="ToposPlayground/Env/Secrets.html">Secrets</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/EnvRegistry" data-name="toposplayground::envregistry">
      <a href="ToposPlayground/EnvRegistry.html">EnvRegistry</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Error" data-name="toposplayground::error">
      <a href="ToposPlayground/Error.html">Error</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/ErrorLog" data-name="toposplayground::errorlog">
      <a href="ToposPlayground/ErrorLog.html">ErrorLog</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/Registry" data-name="toposplayground::registry">
      <a href="ToposPlayground/Registry.html">Registry</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/StderrConsoleFormat" data-name="toposplayground::stderrconsoleformat">
      <a href="ToposPlayground/StderrConsoleFormat.html">StderrConsoleFormat</a>
      
    </li>
  
  <li class=" " data-id="topos-playground.cr/ToposPlayground/StdoutConsoleFormat" data-name="toposplayground::stdoutconsoleformat">
      <a href="ToposPlayground/StdoutConsoleFormat.html">StdoutConsoleFormat</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<p><img src="https://img.shields.io/github/actions/workflow/status/wyhaines/topos-playground.cr/ci.yml?branch=main&amp;style=for-the-badge&amp;logo=GitHub" alt="Topos Playground CI" />
<a href="https://github.com/wyhaines/topos-playground.cr/releases"><img src="https://img.shields.io/github/release/wyhaines/topos-playground.cr.svg?style=for-the-badge" alt="GitHub release" /></a>
<img src="https://img.shields.io/github/commits-since/wyhaines/topos-playground.cr/latest?style=for-the-badge" alt="GitHub commits since latest release (by SemVer)" /></p>
<div id="top" />
<br />
<div align="center">
  <img src="https://raw.githubusercontent.com/topos-protocol/topos-playground/main/.github/assets/topos_logo_dark.png#gh-dark-mode-only" alt="Logo" width="200">
  <br />
  <p align="center">
  <b>Topos Playground</b> is a CLI (command-line interface) to run a local Topos devnet 🚀
  </p>
  <p>
  This version in an unofficial version inspired by <a href="https://github.com/topos-protocol/topos-playground">the official version of topos-playground</a>. This version should have feature-parity with the official version, and may have additional features. This version is also distributed as a standalone binary instead of a Node.js application.
  </p>
  <br />
</div>
<h2><a id="getting-started" class="anchor" href="#getting-started">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Getting Started</h2>
<p>The Topos Playground is a CLI that allows you to easily run and manage a local Topos devnet. The components that it runs on your behalf depend on Docker, Docker Compose, and NodeJS to locally run multiple subnets, multiple TCE nodes, and a dApp with supporting infrastructure, capable of cross-subnet messaging. For official documentation about Topos and about the official Playground CLI, take a look at the <a href="https://docs.topos.technology">Topos Developer Portal</a>.</p>
<p>This document, along with API documentation of this implementation of the Topos Playground can also be accessed at <a href="https://wyhaines.github.io/topos-playground.cr/">https://wyhaines.github.io/topos-playground.cr/</a>.</p>
<h3><a id="requirements" class="anchor" href="#requirements">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Requirements</h3>
<ul>
<li><a href="https://docs.docker.com/get-docker/_">Docker</a> version 17.06.0 or greater</li>
<li><a href="https://docs.docker.com/compose/install/">Docker Compose</a> version 2.0.0 or greater</li>
<li><a href="https://nodejs.dev/en/">NodeJS</a> version 16.0.0 or greater</li>
<li>Git</li>
</ul>
<h3><a id="install-run-topos-playground" class="anchor" href="#install-run-topos-playground">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Install / Run topos-playground</h3>
<p>Precompiled, statically linked binaries are available for Linux and for MacOS from the <a href="https://github.com/wyhaines/topos-playground.cr/releases">Releases</a> tab in this github repository. Download the appropriate binary for your platform, and uncompress it. You may want to rename it to just <code>topos-playground</code>, as all precompiled binaries reflect the architecture and platform that they were compiled for in their names, and you may want to move it into your $PATH:</p>
<pre><code class="language-crystal">gzip -d topos-playground-linux-x86_64.gz # or `unzip topos-playground-darwin.zip`
mv topos-playground-linux-x86_64 topos-playground`
</code></pre>
<h4><a id="install-via-git" class="anchor" href="#install-via-git">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Install via Git</h4>
<p>If you prefer to install the playground via Git, you can clone the repository and build it manually. This will require that you have <a href="https://crystal-lang.org/install/">Crystal</a> installed.</p>
<pre><code class="language-crystal">$ git clone https://github.com/wyhaines/topos-playground.cr.git
$ cd topos-playground.cr
$ shards build --release</code></pre>
<p>The compiled <code>topos-playground</code> will be placed into <code>bin/topos-playground</code>.</p>
<h3><a id="run-the-cli" class="anchor" href="#run-the-cli">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Run the CLI</h3>
<pre><code class="language-crystal">$ topos-playground --help</code></pre>
<p>Topos Playground supports two subcommands, <code>start</code> and <code>clean</code>.</p>
<pre><code class="language-crystal">$ topos-playground start</code></pre>
<p>This will check that the required prerequisites are met, and will then setup and start all of the containers for a complete local Topos network. It will report progress to the console as well as logging to a file.</p>
<pre><code class="language-crystal">$ topos-playground clean</code></pre>
<p>To clean up any still-running docker containers or filesystem artifacts from a previous invocation of the topos-playground, use the <code>clean</code> command.</p>
<p>The playground respects XDG Base Directory Specifications, so by default, it will store data used while running in <code>$HOME/.local/share/topos-playground</code> and it will store logs in <code>$HOME/.state/topos-playground/logs</code>.</p>
<p>To override these default locations, you can set your <code>HOME</code>, <code>XDG_DATA_HOME</code> and <code>XDG_STATE_HOME</code> environment variables, or specify them in a <code>.env</code> file.</p>
<pre><code class="language-crystal">$ HOME=/tmp topos-playground start</code></pre>
<p>By default, topos-playground sends output to both your console and to a log file when it is running. To disable this, you can use the <code>--quiet</code> flag to prevent output from going to the console, or the <code>--no-log</code> flag to prevent output from going to the log file.</p>
<pre><code class="language-crystal">$ topos-playground clean --quiet</code></pre>
<p>For more in-depth discussion about the playground components, and what the <code>topos-playground</code> is doing, take a look at the <a href="https://docs.topos.technology/content/module-2/3-components.html">Topos Playground components</a> portion of the Topos Developer Portal.</p>
<h3><a id="development" class="anchor" href="#development">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Development</h3>
<p>To contribute to the development of this version of the playground, <a href="https://github.com/wyhaines/topos-playground.cr/fork">fork</a> the repository.</p>
<p>Do your work within a branch on your fork. When it is ready, create a Pull Request that clearly explains the reasoning behind your code changes, what they do, and anything that we should be aware of when testing your code.</p>
<p>i.e.</p>
<ol>
<li>Fork it (<a href="https://github.com/wyhaines/topos-playground/fork">https://github.com/wyhaines/topos-playground/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
<h3><a id="discussion" class="anchor" href="#discussion">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Discussion</h3>
<p>For Topos community help or discussion, you can join the Topos Discord server:</p>
<p><a href="https://discord.gg/zMCqqCbGMV">https://discord.gg/zMCqqCbGMV</a></p>
<h3><a id="troubleshooting" class="anchor" href="#troubleshooting">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Troubleshooting</h3>
<ul>
<li><code>Running the redis server...❗ Error</code></li>
</ul>
<p>The container that provides the Redis service was unable to start. This is likely because you are already running a Redis instance on your system. Try shutting it down.</p>
<p>On Linux:</p>
<pre><code class="language-crystal">$ sudo systemctl stop redis-server</code></pre>
<p>or</p>
<pre><code class="language-crystal">$ sudo service redis-server stop</code></pre>
<p>On MacOS:</p>
<pre><code class="language-crystal">brew services stop redis</code></pre>
<p>If you manually installed and started Redis, you will need to manually stop it.</p>
<pre><code class="language-crystal">$ redis-cli shutdown</code></pre>
<ul>
<li><code>docker: Error response from daemon: Conflict. The container name &quot;/redis-stack-server&quot; is already in use by container &quot;1ccdeb3adf2259168a5f74697013eaab8d61fb18e123e0a4d06545ac4269cc94&quot;. You have to remove (or rename) that container to be able to reuse that name.</code></li>
</ul>
<p>This error indicates that the <code>redis-stack-server</code> container is already running. This is likely because you have already ran the playground, but a <code>topos-playground clean</code> was never ran. To fix this, run <code>topos-playground clean</code> and then try again.</p>
<p>This may also sometimes occur if you have a local redis instance running. Refer to the instructions above for how to shut down a local redis instance.</p>
<ul>
<li><code>Error: service &quot;contracts-incal&quot; didn't complete successfully: exit 1</code></li>
</ul>
<p>One cause of this error is a previous failure when starting the playground that wasn't cleaned up by running <code>topos-playground clean</code>. To fix this, run <code>topos-playground clean</code> and then try again.</p>
<ul>
<li><code>Error: info: unknown shorthand flag: 'd' in -d</code></li>
</ul>
<p>If you see this error, you likely do not have Docker Compose installed. You need version 2 or greater. Refer to the <a href="https://docs.docker.com/compose/install/">Docker Compose installation instructions</a> for your platform.</p>
<ul>
<li><code>Error: failed to create network local-erc20-messaging-infra-docker: Error response from daemon: could not find an available, non-overlapping IPv4 address pool among the defaults to assign to the network</code></li>
</ul>
<p>The likely cause of this error is that you are running a VPN of some sort.</p>
<p>The quick fix for this is to shut down your VPN, and then try to run the playground again.</p>
<ul>
<li><code>Error: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</code></li>
</ul>
<p>If this error occurs, it likely means that your <code>dockerd</code> daemon is not running. Please consult the documentation for your OS and Docker installation to determine how to correctly restart it for your platform.</p>
<ul>
<li><code>Error: Error response from daemon: driver failed programming external connectivity on endpoint infra-tce-boot-1 (145130455efa244316eb0570064adb584e2c99d18fa2cd8f58b2774f1144d2bb): (iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 32807 -j DNAT --to-destination 172.21.0.9:9090 ! -i br-de97b637b33b: iptables v1.8.7 (nf_tables): unknown option &quot;--to-destination&quot;</code></li>
</ul>
<p>If this error occurs, you are running Linux, and you have recently done an OS upgrade, try rebooting your system. If the problem persists, first ensure that you can load the 'xt_nat' kernel module:</p>
<pre><code class="language-crystal">$ sudo modprobe xt_nat</code></pre>
<p>If that command fails, then this is likely the problem. You can try to load the module manually:</p>
<pre><code class="language-crystal">$ sudo insmod /lib/modules/$(uname -r)/kernel/net/netfilter/xt_nat.ko</code></pre>
<p>And then try again.</p>
<p>If that command succeeds, but the problem persists, check your iptables version:</p>
<pre><code class="language-crystal">$ iptables --version</code></pre>
<p>It should show something like this:</p>
<pre><code class="language-crystal">iptables v1.8.7 (nf_tables)</code></pre>
<p>If the <code>nf_tables</code> is absent, and you have already tried to reboot, investigate your <code>/usr/sbin/iptables</code> symlink. It should point to <code>/usr/sbin/xtables-nft-multi</code>. It should, either via a direct link, or perhaps through a chain of symlinks, point to <code>/usr/sbin/xtables-nft-multi</code>.</p>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/wyhaines">Kirk Haines</a> - creator and maintainer</li>
</ul>
</div>
</body>
</html>
